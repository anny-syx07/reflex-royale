class ConquestGrid{constructor(e=10){this.size=e,this.grid=Array(e).fill(null).map(()=>Array(e).fill(null)),this.specialCells=[]}initializeSpecialCells(e=8){this.specialCells=[];const t=new Set;for(;this.specialCells.length<e;){const l=Math.floor(Math.random()*this.size),s=Math.floor(Math.random()*this.size),i=`${l},${s}`;t.has(i)||(t.add(i),this.specialCells.push({x:l,y:s,multiplier:this.specialCells.length<e/2?2:3}))}}getCellMultiplier(e,t){const l=this.specialCells.find(l=>l.x===e&&l.y===t);return l?l.multiplier:1}setCell(e,t,l){e>=0&&e<this.size&&t>=0&&t<this.size&&(this.grid[e][t]=l)}getCell(e,t){return e>=0&&e<this.size&&t>=0&&t<this.size?this.grid[e][t]:null}countTerritory(e){let t=0;for(let l=0;l<this.size;l++)for(let s=0;s<this.size;s++)this.grid[l][s]===e&&(t+=this.getCellMultiplier(l,s));return t}getAllTerritories(){const e=new Map;for(let t=0;t<this.size;t++)for(let l=0;l<this.size;l++){const s=this.grid[t][l];if(null!==s){const i=e.get(s)||0;e.set(s,i+this.getCellMultiplier(t,l))}}return e}export(){return{grid:this.grid.map(e=>[...e]),specialCells:[...this.specialCells]}}import(e){this.grid=e.grid.map(e=>[...e]),this.specialCells=[...e.specialCells]}}class ConquestRenderer{constructor(e,t,l={}){this.container=e,this.grid=t,this.options={large:l.large||!1,clickable:!1!==l.clickable,showPlayerColor:!1!==l.showPlayerColor},this.playerColorMap=new Map,this.colorIndex=0,this.render()}getPlayerColor(e){return this.playerColorMap.has(e)||(this.playerColorMap.set(e,this.colorIndex%12),this.colorIndex++),this.playerColorMap.get(e)}render(){this.container.innerHTML="",this.container.className="grid-container "+(this.options.large?"large":"");for(let e=0;e<this.grid.size;e++)for(let t=0;t<this.grid.size;t++){const l=this.createCell(t,e);this.container.appendChild(l)}}createCell(e,t){const l=document.createElement("div");l.className="grid-cell",l.dataset.x=e,l.dataset.y=t;const s=this.grid.getCell(e,t);if(null!==s&&this.options.showPlayerColor){const e=this.getPlayerColor(s);l.classList.add(`player-color-${e}`),l.classList.add("owned")}const i=this.grid.getCellMultiplier(e,t);if(i>1){l.classList.add(`special-${i}x`);const e=document.createElement("span");e.className="cell-multiplier",e.textContent=`Ã—${i}`,l.appendChild(e)}return this.options.clickable&&null===s&&l.addEventListener("click",()=>this.onCellClick(e,t)),l}updateCell(e,t){const l=this.container.querySelector(`[data-x="${e}"][data-y="${t}"]`);if(!l)return;const s=this.grid.getCell(e,t);for(let e=0;e<12;e++)l.classList.remove(`player-color-${e}`);if(l.classList.remove("owned","pending"),null!==s&&this.options.showPlayerColor){const e=this.getPlayerColor(s);l.classList.add(`player-color-${e}`),l.classList.add("owned"),l.classList.add("claimed"),setTimeout(()=>l.classList.remove("claimed"),400)}}showConflict(e,t){const l=this.container.querySelector(`[data-x="${e}"][data-y="${t}"]`);l&&(l.classList.add("conflict"),setTimeout(()=>l.classList.remove("conflict"),600))}markPending(e,t,l){const s=this.container.querySelector(`[data-x="${e}"][data-y="${t}"]`);s&&(l?s.classList.add("pending"):s.classList.remove("pending"))}onCellClick(e,t){console.log(`Cell clicked: (${e}, ${t})`)}}function formatTime(e){return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`}function playSound(e){console.log(`Sound: ${e}`)}"undefined"!=typeof module&&module.exports&&(module.exports={ConquestGrid:ConquestGrid,ConquestRenderer:ConquestRenderer,formatTime:formatTime,playSound:playSound});